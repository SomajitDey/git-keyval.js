var Re=Object.create;var bt=Object.defineProperty;var Me=Object.getOwnPropertyDescriptor;var $e=Object.getOwnPropertyNames;var ze=Object.getPrototypeOf,je=Object.prototype.hasOwnProperty;var Be=(i,t)=>()=>(i&&(t=i(i=0)),t);var Ne=(i,t)=>()=>(t||i((t={exports:{}}).exports,t),t.exports),He=(i,t)=>{for(var e in t)bt(i,e,{get:t[e],enumerable:!0})},Ie=(i,t,e,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of $e(t))!je.call(i,r)&&r!==e&&bt(i,r,{get:()=>t[r],enumerable:!(s=Me(t,r))||s.enumerable});return i};var We=(i,t,e)=>(e=i!=null?Re(ze(i)):{},Ie(t||!i||!i.__esModule?bt(e,"default",{value:i,enumerable:!0}):e,i));var Kt={};He(Kt,{LRUCache:()=>si});var j,Vt,St,Yt,lt,kt,ei,Yi,D,Zt,ht,ii,si,Xt=Be(()=>{j=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,Vt=new Set,St=typeof process=="object"&&process?process:{},Yt=(i,t,e,s)=>{typeof St.emitWarning=="function"?St.emitWarning(i,t,e,s):console.error(`[${e}] ${t}: ${i}`)},lt=globalThis.AbortController,kt=globalThis.AbortSignal;if(typeof lt>"u"){kt=class{onabort;_onabort=[];reason;aborted=!1;addEventListener(e,s){this._onabort.push(s)}},lt=class{constructor(){t()}signal=new kt;abort(e){if(!this.signal.aborted){this.signal.reason=e,this.signal.aborted=!0;for(let s of this.signal._onabort)s(e);this.signal.onabort?.(e)}}};let i=St.env?.LRU_CACHE_IGNORE_AC_WARNING!=="1",t=()=>{i&&(i=!1,Yt("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",t))}}ei=i=>!Vt.has(i),Yi=Symbol("type"),D=i=>i&&i===Math.floor(i)&&i>0&&isFinite(i),Zt=i=>D(i)?i<=Math.pow(2,8)?Uint8Array:i<=Math.pow(2,16)?Uint16Array:i<=Math.pow(2,32)?Uint32Array:i<=Number.MAX_SAFE_INTEGER?ht:null:null,ht=class extends Array{constructor(i){super(i),this.fill(0)}},ii=class V{heap;length;static#n=!1;static create(t){let e=Zt(t);if(!e)return[];V.#n=!0;let s=new V(t,e);return V.#n=!1,s}constructor(t,e){if(!V.#n)throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new e(t),this.length=0}push(t){this.heap[this.length++]=t}pop(){return this.heap[--this.length]}},si=class Jt{#n;#u;#m;#O;#y;#U;#R;ttl;ttlResolution;ttlAutopurge;updateAgeOnGet;updateAgeOnHas;allowStale;noDisposeOnSet;noUpdateTTL;maxEntrySize;sizeCalculation;noDeleteOnFetchRejection;noDeleteOnStaleGet;allowStaleOnFetchAbort;allowStaleOnFetchRejection;ignoreFetchAbort;#r;#g;#s;#i;#t;#l;#f;#h;#o;#w;#a;#b;#x;#d;#T;#E;#c;#M;static unsafeExposeInternals(t){return{starts:t.#x,ttls:t.#d,sizes:t.#b,keyMap:t.#s,keyList:t.#i,valList:t.#t,next:t.#l,prev:t.#f,get head(){return t.#h},get tail(){return t.#o},free:t.#w,isBackgroundFetch:e=>t.#e(e),backgroundFetch:(e,s,r,n)=>t.#j(e,s,r,n),moveToTail:e=>t.#F(e),indexes:e=>t.#v(e),rindexes:e=>t.#S(e),isStale:e=>t.#p(e)}}get max(){return this.#n}get maxSize(){return this.#u}get calculatedSize(){return this.#g}get size(){return this.#r}get fetchMethod(){return this.#U}get memoMethod(){return this.#R}get dispose(){return this.#m}get onInsert(){return this.#O}get disposeAfter(){return this.#y}constructor(t){let{max:e=0,ttl:s,ttlResolution:r=1,ttlAutopurge:n,updateAgeOnGet:o,updateAgeOnHas:a,allowStale:h,dispose:u,onInsert:d,disposeAfter:l,noDisposeOnSet:c,noUpdateTTL:p,maxSize:b=0,maxEntrySize:m=0,sizeCalculation:w,fetchMethod:f,memoMethod:y,noDeleteOnFetchRejection:v,noDeleteOnStaleGet:g,allowStaleOnFetchRejection:T,allowStaleOnFetchAbort:E,ignoreFetchAbort:A}=t;if(e!==0&&!D(e))throw new TypeError("max option must be a nonnegative integer");let O=e?Zt(e):Array;if(!O)throw new Error("invalid max value: "+e);if(this.#n=e,this.#u=b,this.maxEntrySize=m||this.#u,this.sizeCalculation=w,this.sizeCalculation){if(!this.#u&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(y!==void 0&&typeof y!="function")throw new TypeError("memoMethod must be a function if defined");if(this.#R=y,f!==void 0&&typeof f!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.#U=f,this.#E=!!f,this.#s=new Map,this.#i=new Array(e).fill(void 0),this.#t=new Array(e).fill(void 0),this.#l=new O(e),this.#f=new O(e),this.#h=0,this.#o=0,this.#w=ii.create(e),this.#r=0,this.#g=0,typeof u=="function"&&(this.#m=u),typeof d=="function"&&(this.#O=d),typeof l=="function"?(this.#y=l,this.#a=[]):(this.#y=void 0,this.#a=void 0),this.#T=!!this.#m,this.#M=!!this.#O,this.#c=!!this.#y,this.noDisposeOnSet=!!c,this.noUpdateTTL=!!p,this.noDeleteOnFetchRejection=!!v,this.allowStaleOnFetchRejection=!!T,this.allowStaleOnFetchAbort=!!E,this.ignoreFetchAbort=!!A,this.maxEntrySize!==0){if(this.#u!==0&&!D(this.#u))throw new TypeError("maxSize must be a positive integer if specified");if(!D(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.#q()}if(this.allowStale=!!h,this.noDeleteOnStaleGet=!!g,this.updateAgeOnGet=!!o,this.updateAgeOnHas=!!a,this.ttlResolution=D(r)||r===0?r:1,this.ttlAutopurge=!!n,this.ttl=s||0,this.ttl){if(!D(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.#B()}if(this.#n===0&&this.ttl===0&&this.#u===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.#n&&!this.#u){let _="LRU_CACHE_UNBOUNDED";ei(_)&&(Vt.add(_),Yt("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",_,Jt))}}getRemainingTTL(t){return this.#s.has(t)?1/0:0}#B(){let t=new ht(this.#n),e=new ht(this.#n);this.#d=t,this.#x=e,this.#N=(n,o,a=j.now())=>{if(e[n]=o!==0?a:0,t[n]=o,o!==0&&this.ttlAutopurge){let h=setTimeout(()=>{this.#p(n)&&this.#A(this.#i[n],"expire")},o+1);h.unref&&h.unref()}},this.#C=n=>{e[n]=t[n]!==0?j.now():0},this.#_=(n,o)=>{if(t[o]){let a=t[o],h=e[o];if(!a||!h)return;n.ttl=a,n.start=h,n.now=s||r();let u=n.now-h;n.remainingTTL=a-u}};let s=0,r=()=>{let n=j.now();if(this.ttlResolution>0){s=n;let o=setTimeout(()=>s=0,this.ttlResolution);o.unref&&o.unref()}return n};this.getRemainingTTL=n=>{let o=this.#s.get(n);if(o===void 0)return 0;let a=t[o],h=e[o];if(!a||!h)return 1/0;let u=(s||r())-h;return a-u},this.#p=n=>{let o=e[n],a=t[n];return!!a&&!!o&&(s||r())-o>a}}#C=()=>{};#_=()=>{};#N=()=>{};#p=()=>!1;#q(){let t=new ht(this.#n);this.#g=0,this.#b=t,this.#D=e=>{this.#g-=t[e],t[e]=0},this.#H=(e,s,r,n)=>{if(this.#e(s))return 0;if(!D(r))if(n){if(typeof n!="function")throw new TypeError("sizeCalculation must be a function");if(r=n(s,e),!D(r))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return r},this.#$=(e,s,r)=>{if(t[e]=s,this.#u){let n=this.#u-t[e];for(;this.#g>n;)this.#z(!0)}this.#g+=t[e],r&&(r.entrySize=s,r.totalCalculatedSize=this.#g)}}#D=t=>{};#$=(t,e,s)=>{};#H=(t,e,s,r)=>{if(s||r)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0};*#v({allowStale:t=this.allowStale}={}){if(this.#r)for(let e=this.#o;!(!this.#I(e)||((t||!this.#p(e))&&(yield e),e===this.#h));)e=this.#f[e]}*#S({allowStale:t=this.allowStale}={}){if(this.#r)for(let e=this.#h;!(!this.#I(e)||((t||!this.#p(e))&&(yield e),e===this.#o));)e=this.#l[e]}#I(t){return t!==void 0&&this.#s.get(this.#i[t])===t}*entries(){for(let t of this.#v())this.#t[t]!==void 0&&this.#i[t]!==void 0&&!this.#e(this.#t[t])&&(yield[this.#i[t],this.#t[t]])}*rentries(){for(let t of this.#S())this.#t[t]!==void 0&&this.#i[t]!==void 0&&!this.#e(this.#t[t])&&(yield[this.#i[t],this.#t[t]])}*keys(){for(let t of this.#v()){let e=this.#i[t];e!==void 0&&!this.#e(this.#t[t])&&(yield e)}}*rkeys(){for(let t of this.#S()){let e=this.#i[t];e!==void 0&&!this.#e(this.#t[t])&&(yield e)}}*values(){for(let t of this.#v())this.#t[t]!==void 0&&!this.#e(this.#t[t])&&(yield this.#t[t])}*rvalues(){for(let t of this.#S())this.#t[t]!==void 0&&!this.#e(this.#t[t])&&(yield this.#t[t])}[Symbol.iterator](){return this.entries()}[Symbol.toStringTag]="LRUCache";find(t,e={}){for(let s of this.#v()){let r=this.#t[s],n=this.#e(r)?r.__staleWhileFetching:r;if(n!==void 0&&t(n,this.#i[s],this))return this.get(this.#i[s],e)}}forEach(t,e=this){for(let s of this.#v()){let r=this.#t[s],n=this.#e(r)?r.__staleWhileFetching:r;n!==void 0&&t.call(e,n,this.#i[s],this)}}rforEach(t,e=this){for(let s of this.#S()){let r=this.#t[s],n=this.#e(r)?r.__staleWhileFetching:r;n!==void 0&&t.call(e,n,this.#i[s],this)}}purgeStale(){let t=!1;for(let e of this.#S({allowStale:!0}))this.#p(e)&&(this.#A(this.#i[e],"expire"),t=!0);return t}info(t){let e=this.#s.get(t);if(e===void 0)return;let s=this.#t[e],r=this.#e(s)?s.__staleWhileFetching:s;if(r===void 0)return;let n={value:r};if(this.#d&&this.#x){let o=this.#d[e],a=this.#x[e];if(o&&a){let h=o-(j.now()-a);n.ttl=h,n.start=Date.now()}}return this.#b&&(n.size=this.#b[e]),n}dump(){let t=[];for(let e of this.#v({allowStale:!0})){let s=this.#i[e],r=this.#t[e],n=this.#e(r)?r.__staleWhileFetching:r;if(n===void 0||s===void 0)continue;let o={value:n};if(this.#d&&this.#x){o.ttl=this.#d[e];let a=j.now()-this.#x[e];o.start=Math.floor(Date.now()-a)}this.#b&&(o.size=this.#b[e]),t.unshift([s,o])}return t}load(t){this.clear();for(let[e,s]of t){if(s.start){let r=Date.now()-s.start;s.start=j.now()-r}this.set(e,s.value,s)}}set(t,e,s={}){if(e===void 0)return this.delete(t),this;let{ttl:r=this.ttl,start:n,noDisposeOnSet:o=this.noDisposeOnSet,sizeCalculation:a=this.sizeCalculation,status:h}=s,{noUpdateTTL:u=this.noUpdateTTL}=s,d=this.#H(t,e,s.size||0,a);if(this.maxEntrySize&&d>this.maxEntrySize)return h&&(h.set="miss",h.maxEntrySizeExceeded=!0),this.#A(t,"set"),this;let l=this.#r===0?void 0:this.#s.get(t);if(l===void 0)l=this.#r===0?this.#o:this.#w.length!==0?this.#w.pop():this.#r===this.#n?this.#z(!1):this.#r,this.#i[l]=t,this.#t[l]=e,this.#s.set(t,l),this.#l[this.#o]=l,this.#f[l]=this.#o,this.#o=l,this.#r++,this.#$(l,d,h),h&&(h.set="add"),u=!1,this.#M&&this.#O?.(e,t,"add");else{this.#F(l);let c=this.#t[l];if(e!==c){if(this.#E&&this.#e(c)){c.__abortController.abort(new Error("replaced"));let{__staleWhileFetching:p}=c;p!==void 0&&!o&&(this.#T&&this.#m?.(p,t,"set"),this.#c&&this.#a?.push([p,t,"set"]))}else o||(this.#T&&this.#m?.(c,t,"set"),this.#c&&this.#a?.push([c,t,"set"]));if(this.#D(l),this.#$(l,d,h),this.#t[l]=e,h){h.set="replace";let p=c&&this.#e(c)?c.__staleWhileFetching:c;p!==void 0&&(h.oldValue=p)}}else h&&(h.set="update");this.#M&&this.onInsert?.(e,t,e===c?"update":"replace")}if(r!==0&&!this.#d&&this.#B(),this.#d&&(u||this.#N(l,r,n),h&&this.#_(h,l)),!o&&this.#c&&this.#a){let c=this.#a,p;for(;p=c?.shift();)this.#y?.(...p)}return this}pop(){try{for(;this.#r;){let t=this.#t[this.#h];if(this.#z(!0),this.#e(t)){if(t.__staleWhileFetching)return t.__staleWhileFetching}else if(t!==void 0)return t}}finally{if(this.#c&&this.#a){let t=this.#a,e;for(;e=t?.shift();)this.#y?.(...e)}}}#z(t){let e=this.#h,s=this.#i[e],r=this.#t[e];return this.#E&&this.#e(r)?r.__abortController.abort(new Error("evicted")):(this.#T||this.#c)&&(this.#T&&this.#m?.(r,s,"evict"),this.#c&&this.#a?.push([r,s,"evict"])),this.#D(e),t&&(this.#i[e]=void 0,this.#t[e]=void 0,this.#w.push(e)),this.#r===1?(this.#h=this.#o=0,this.#w.length=0):this.#h=this.#l[e],this.#s.delete(s),this.#r--,e}has(t,e={}){let{updateAgeOnHas:s=this.updateAgeOnHas,status:r}=e,n=this.#s.get(t);if(n!==void 0){let o=this.#t[n];if(this.#e(o)&&o.__staleWhileFetching===void 0)return!1;if(this.#p(n))r&&(r.has="stale",this.#_(r,n));else return s&&this.#C(n),r&&(r.has="hit",this.#_(r,n)),!0}else r&&(r.has="miss");return!1}peek(t,e={}){let{allowStale:s=this.allowStale}=e,r=this.#s.get(t);if(r===void 0||!s&&this.#p(r))return;let n=this.#t[r];return this.#e(n)?n.__staleWhileFetching:n}#j(t,e,s,r){let n=e===void 0?void 0:this.#t[e];if(this.#e(n))return n;let o=new lt,{signal:a}=s;a?.addEventListener("abort",()=>o.abort(a.reason),{signal:o.signal});let h={signal:o.signal,options:s,context:r},u=(m,w=!1)=>{let{aborted:f}=o.signal,y=s.ignoreFetchAbort&&m!==void 0;if(s.status&&(f&&!w?(s.status.fetchAborted=!0,s.status.fetchError=o.signal.reason,y&&(s.status.fetchAbortIgnored=!0)):s.status.fetchResolved=!0),f&&!y&&!w)return l(o.signal.reason);let v=p;return this.#t[e]===p&&(m===void 0?v.__staleWhileFetching?this.#t[e]=v.__staleWhileFetching:this.#A(t,"fetch"):(s.status&&(s.status.fetchUpdated=!0),this.set(t,m,h.options))),m},d=m=>(s.status&&(s.status.fetchRejected=!0,s.status.fetchError=m),l(m)),l=m=>{let{aborted:w}=o.signal,f=w&&s.allowStaleOnFetchAbort,y=f||s.allowStaleOnFetchRejection,v=y||s.noDeleteOnFetchRejection,g=p;if(this.#t[e]===p&&(!v||g.__staleWhileFetching===void 0?this.#A(t,"fetch"):f||(this.#t[e]=g.__staleWhileFetching)),y)return s.status&&g.__staleWhileFetching!==void 0&&(s.status.returnedStale=!0),g.__staleWhileFetching;if(g.__returned===g)throw m},c=(m,w)=>{let f=this.#U?.(t,n,h);f&&f instanceof Promise&&f.then(y=>m(y===void 0?void 0:y),w),o.signal.addEventListener("abort",()=>{(!s.ignoreFetchAbort||s.allowStaleOnFetchAbort)&&(m(void 0),s.allowStaleOnFetchAbort&&(m=y=>u(y,!0)))})};s.status&&(s.status.fetchDispatched=!0);let p=new Promise(c).then(u,d),b=Object.assign(p,{__abortController:o,__staleWhileFetching:n,__returned:void 0});return e===void 0?(this.set(t,b,{...h.options,status:void 0}),e=this.#s.get(t)):this.#t[e]=b,b}#e(t){if(!this.#E)return!1;let e=t;return!!e&&e instanceof Promise&&e.hasOwnProperty("__staleWhileFetching")&&e.__abortController instanceof lt}async fetch(t,e={}){let{allowStale:s=this.allowStale,updateAgeOnGet:r=this.updateAgeOnGet,noDeleteOnStaleGet:n=this.noDeleteOnStaleGet,ttl:o=this.ttl,noDisposeOnSet:a=this.noDisposeOnSet,size:h=0,sizeCalculation:u=this.sizeCalculation,noUpdateTTL:d=this.noUpdateTTL,noDeleteOnFetchRejection:l=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:c=this.allowStaleOnFetchRejection,ignoreFetchAbort:p=this.ignoreFetchAbort,allowStaleOnFetchAbort:b=this.allowStaleOnFetchAbort,context:m,forceRefresh:w=!1,status:f,signal:y}=e;if(!this.#E)return f&&(f.fetch="get"),this.get(t,{allowStale:s,updateAgeOnGet:r,noDeleteOnStaleGet:n,status:f});let v={allowStale:s,updateAgeOnGet:r,noDeleteOnStaleGet:n,ttl:o,noDisposeOnSet:a,size:h,sizeCalculation:u,noUpdateTTL:d,noDeleteOnFetchRejection:l,allowStaleOnFetchRejection:c,allowStaleOnFetchAbort:b,ignoreFetchAbort:p,status:f,signal:y},g=this.#s.get(t);if(g===void 0){f&&(f.fetch="miss");let T=this.#j(t,g,v,m);return T.__returned=T}else{let T=this.#t[g];if(this.#e(T)){let _=s&&T.__staleWhileFetching!==void 0;return f&&(f.fetch="inflight",_&&(f.returnedStale=!0)),_?T.__staleWhileFetching:T.__returned=T}let E=this.#p(g);if(!w&&!E)return f&&(f.fetch="hit"),this.#F(g),r&&this.#C(g),f&&this.#_(f,g),T;let A=this.#j(t,g,v,m),O=A.__staleWhileFetching!==void 0&&s;return f&&(f.fetch=E?"stale":"refresh",O&&E&&(f.returnedStale=!0)),O?A.__staleWhileFetching:A.__returned=A}}async forceFetch(t,e={}){let s=await this.fetch(t,e);if(s===void 0)throw new Error("fetch() returned undefined");return s}memo(t,e={}){let s=this.#R;if(!s)throw new Error("no memoMethod provided to constructor");let{context:r,forceRefresh:n,...o}=e,a=this.get(t,o);if(!n&&a!==void 0)return a;let h=s(t,a,{options:o,context:r});return this.set(t,h,o),h}get(t,e={}){let{allowStale:s=this.allowStale,updateAgeOnGet:r=this.updateAgeOnGet,noDeleteOnStaleGet:n=this.noDeleteOnStaleGet,status:o}=e,a=this.#s.get(t);if(a!==void 0){let h=this.#t[a],u=this.#e(h);return o&&this.#_(o,a),this.#p(a)?(o&&(o.get="stale"),u?(o&&s&&h.__staleWhileFetching!==void 0&&(o.returnedStale=!0),s?h.__staleWhileFetching:void 0):(n||this.#A(t,"expire"),o&&s&&(o.returnedStale=!0),s?h:void 0)):(o&&(o.get="hit"),u?h.__staleWhileFetching:(this.#F(a),r&&this.#C(a),h))}else o&&(o.get="miss")}#W(t,e){this.#f[e]=t,this.#l[t]=e}#F(t){t!==this.#o&&(t===this.#h?this.#h=this.#l[t]:this.#W(this.#f[t],this.#l[t]),this.#W(this.#o,t),this.#o=t)}delete(t){return this.#A(t,"delete")}#A(t,e){let s=!1;if(this.#r!==0){let r=this.#s.get(t);if(r!==void 0)if(s=!0,this.#r===1)this.#L(e);else{this.#D(r);let n=this.#t[r];if(this.#e(n)?n.__abortController.abort(new Error("deleted")):(this.#T||this.#c)&&(this.#T&&this.#m?.(n,t,e),this.#c&&this.#a?.push([n,t,e])),this.#s.delete(t),this.#i[r]=void 0,this.#t[r]=void 0,r===this.#o)this.#o=this.#f[r];else if(r===this.#h)this.#h=this.#l[r];else{let o=this.#f[r];this.#l[o]=this.#l[r];let a=this.#l[r];this.#f[a]=this.#f[r]}this.#r--,this.#w.push(r)}}if(this.#c&&this.#a?.length){let r=this.#a,n;for(;n=r?.shift();)this.#y?.(...n)}return s}clear(){return this.#L("delete")}#L(t){for(let e of this.#S({allowStale:!0})){let s=this.#t[e];if(this.#e(s))s.__abortController.abort(new Error("deleted"));else{let r=this.#i[e];this.#T&&this.#m?.(s,r,t),this.#c&&this.#a?.push([s,r,t])}}if(this.#s.clear(),this.#t.fill(void 0),this.#i.fill(void 0),this.#d&&this.#x&&(this.#d.fill(0),this.#x.fill(0)),this.#b&&this.#b.fill(0),this.#h=0,this.#o=0,this.#w.length=0,this.#g=0,this.#r=0,this.#c&&this.#a){let e=this.#a,s;for(;s=e?.shift();)this.#y?.(...s)}}}});var we=Ne((os,Q)=>{"use strict";var pt=function(){};pt.prototype=Object.create(null);var ft=/; *([!#$%&'*+.^\w`|~-]+)=("(?:[\v\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\v\u0020-\u00ff])*"|[!#$%&'*+.^\w`|~-]+) */gu,dt=/\\([\v\u0020-\u00ff])/gu,me=/^[!#$%&'*+.^\w|~-]+\/[!#$%&'*+.^\w|~-]+$/u,$={type:"",parameters:new pt};Object.freeze($.parameters);Object.freeze($);function ye(i){if(typeof i!="string")throw new TypeError("argument header is required and must be a string");let t=i.indexOf(";"),e=t!==-1?i.slice(0,t).trim():i.trim();if(me.test(e)===!1)throw new TypeError("invalid media type");let s={type:e.toLowerCase(),parameters:new pt};if(t===-1)return s;let r,n,o;for(ft.lastIndex=t;n=ft.exec(i);){if(n.index!==t)throw new TypeError("invalid parameter format");t+=n[0].length,r=n[1].toLowerCase(),o=n[2],o[0]==='"'&&(o=o.slice(1,o.length-1),dt.test(o)&&(o=o.replace(dt,"$1"))),s.parameters[r]=o}if(t!==i.length)throw new TypeError("invalid parameter format");return s}function ge(i){if(typeof i!="string")return $;let t=i.indexOf(";"),e=t!==-1?i.slice(0,t).trim():i.trim();if(me.test(e)===!1)return $;let s={type:e.toLowerCase(),parameters:new pt};if(t===-1)return s;let r,n,o;for(ft.lastIndex=t;n=ft.exec(i);){if(n.index!==t)return $;t+=n[0].length,r=n[1].toLowerCase(),o=n[2],o[0]==='"'&&(o=o.slice(1,o.length-1),dt.test(o)&&(o=o.replace(dt,"$1"))),s.parameters[r]=o}return t!==i.length?$:s}Q.exports.default={parse:ye,safeParse:ge};Q.exports.parse=ye;Q.exports.safeParse=ge;Q.exports.defaultContentType=$});var nt=typeof Buffer=="function",Pi=typeof TextDecoder=="function"?new TextDecoder:void 0,Gi=typeof TextEncoder=="function"?new TextEncoder:void 0,Le="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",G=Array.prototype.slice.call(Le),st=(i=>{let t={};return i.forEach((e,s)=>t[e]=s),t})(G),qe=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,rt=String.fromCharCode.bind(String),Nt=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):i=>new Uint8Array(Array.prototype.slice.call(i,0)),Pe=i=>i.replace(/=/g,"").replace(/[+\/]/g,t=>t=="+"?"-":"_"),It=i=>i.replace(/[^A-Za-z0-9\+\/]/g,""),Ge=i=>{let t,e,s,r,n="",o=i.length%3;for(let a=0;a<i.length;){if((e=i.charCodeAt(a++))>255||(s=i.charCodeAt(a++))>255||(r=i.charCodeAt(a++))>255)throw new TypeError("invalid character found");t=e<<16|s<<8|r,n+=G[t>>18&63]+G[t>>12&63]+G[t>>6&63]+G[t&63]}return o?n.slice(0,o-3)+"===".substring(o):n},ke=typeof btoa=="function"?i=>btoa(i):nt?i=>Buffer.from(i,"binary").toString("base64"):Ge,Ht=nt?i=>Buffer.from(i).toString("base64"):i=>{let e=[];for(let s=0,r=i.length;s<r;s+=4096)e.push(rt.apply(null,i.subarray(s,s+4096)));return ke(e.join(""))},xt=(i,t=!1)=>t?Pe(Ht(i)):Ht(i);var Ve=i=>{if(i=i.replace(/\s+/g,""),!qe.test(i))throw new TypeError("malformed base64.");i+="==".slice(2-(i.length&3));let t,e="",s,r;for(let n=0;n<i.length;)t=st[i.charAt(n++)]<<18|st[i.charAt(n++)]<<12|(s=st[i.charAt(n++)])<<6|(r=st[i.charAt(n++)]),e+=s===64?rt(t>>16&255):r===64?rt(t>>16&255,t>>8&255):rt(t>>16&255,t>>8&255,t&255);return e},Ye=typeof atob=="function"?i=>atob(It(i)):nt?i=>Buffer.from(i,"base64").toString("binary"):Ve,Ze=nt?i=>Nt(Buffer.from(i,"base64")):i=>Nt(Ye(i).split("").map(t=>t.charCodeAt(0))),ot=i=>Ze(Je(i));var Je=i=>It(i.replace(/[-_]/g,t=>t=="-"?"+":"/"));function Wt(i){return xt(i)}function Ke(i){return xt(i,!0)}var Xe=new TextEncoder,Qe=new TextDecoder;function C(i){return Xe.encode(i)}function k(i){return Qe.decode(i)}function Tt(i){return Array.from(i).map(t=>t.toString(16).padStart(2,"0")).join("")}function vt(i){let t=i.length;if(t%2!==0)throw new Error("Number of provided nibbles must be even");let e=[];for(let s=0;s<t;s+=2)e.push(parseInt(i[s]+i[s+1],16));return Uint8Array.from(e)}function Lt(i){return Ke(vt(i))}function qt(i){return Tt(ot(i))}function Pt(i){return new Uint8Array(new Float64Array([i]).buffer)}function Gt(i){return new Float64Array(i.buffer)[0]}async function at([...i]){return new Uint8Array(await new Blob(i).arrayBuffer())}var Y=class i{static mimeDbCdnVersion="4.0.0-1.54.0";static cdnBase=`https://cdn.jsdelivr.net/npm/mime-db-cdn@${i.mimeDbCdnVersion}`;cache;#n={};async fetch(...t){return globalThis.fetch(...t)}constructor({fetch:t,cacheMaxEntries:e}={}){t&&(this.fetch=t),e&&(this.#n.max=e)}async#u(){if(this.cache===void 0&&Object.keys(this.#n).length!==0){let{LRUCache:t}=await Promise.resolve().then(()=>(Xt(),Kt));this.cache=new t(this.#n)}return this.cache}async query(t){let e=i.cdnBase+`/mime-types/${t}/data.json`;return this.fetch(e).then(s=>{if(s.status===404)throw new Error("Not Found");return s.json()})}async mimeToExtensions(t){let[e]=t.split(";"),s=await this.#u(),r=s?.get(e);return r===void 0&&({extensions:r}=await this.query(e),s?.set(e,r)),r??[]}getExtensions=this.mimeToExtensions;async extensionToMimes(t){let e=t.split("/").pop().split(".").pop(),s=await this.#u(),r=s?.get(e);if(r===void 0){let n=i.cdnBase+`/extensions/${e}/data.json`;({mimeTypes:r}=await this.fetch(n).then(o=>{if(o.status===404)throw new Error("Not Found");return o.json()})),s?.set(e,r)}return r??[]}getTypes=this.extensionToMimes;async extensionToMime(t){let[e,...s]=await this.getTypes(t);return e}getType=this.extensionToMime};var ri=new Y({cacheMaxEntries:32}),At=["Number","Boolean","String","JSON","Blob","ArrayBuffer"];function B(i){return Object.prototype.toString.call(i).split(" ").pop().slice(0,-1)}async function Qt(i){let t=B(i);switch(t){case"Number":if(i.toString().length>7)return{type:t,bytes:Pt(i)};case"Boolean":case"String":return{type:t,bytes:C(i.toString()),extension:"txt"};case"Null":case"Array":case"Object":return{type:"JSON",bytes:C(JSON.stringify(i)),extension:"json"};case"Blob":let e=new Uint8Array(await i.arrayBuffer()),s=i.type,[r]=await ri.getExtensions(s).catch(()=>[]);return{type:t,mimeType:s,bytes:e,extension:r};case"Uint8Array":return{bytes:i};case"ArrayBuffer":return{type:t,bytes:new Uint8Array(i)};default:throw new Error("Unsupported parameter type")}}function te({type:i="Uint8Array",mimeType:t,bytes:e}){switch(i){case"Number":return e.length===8?Gt(e):Number(k(e));case"Boolean":return k(e)==="true";case"String":return k(e);case"JSON":return JSON.parse(k(e));case"Blob":return new Blob([e],{type:t});case"ArrayBuffer":return e.buffer;case"Uint8Array":return e;default:throw new Error("Unsupported type")}}var _t={},Z={},ct="en",Et={MMMM:["January","February","March","April","May","June","July","August","September","October","November","December"],MMM:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dddd:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ddd:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dd:["Su","Mo","Tu","We","Th","Fr","Sa"],A:["AM","PM"]},ee={YYYY:function(i){return("000"+i.getFullYear()).slice(-4)},YY:function(i){return("0"+i.getFullYear()).slice(-2)},Y:function(i){return""+i.getFullYear()},MMMM:function(i){return this.res.MMMM[i.getMonth()]},MMM:function(i){return this.res.MMM[i.getMonth()]},MM:function(i){return("0"+(i.getMonth()+1)).slice(-2)},M:function(i){return""+(i.getMonth()+1)},DD:function(i){return("0"+i.getDate()).slice(-2)},D:function(i){return""+i.getDate()},HH:function(i){return("0"+i.getHours()).slice(-2)},H:function(i){return""+i.getHours()},A:function(i){return this.res.A[i.getHours()>11|0]},hh:function(i){return("0"+(i.getHours()%12||12)).slice(-2)},h:function(i){return""+(i.getHours()%12||12)},mm:function(i){return("0"+i.getMinutes()).slice(-2)},m:function(i){return""+i.getMinutes()},ss:function(i){return("0"+i.getSeconds()).slice(-2)},s:function(i){return""+i.getSeconds()},SSS:function(i){return("00"+i.getMilliseconds()).slice(-3)},SS:function(i){return("0"+(i.getMilliseconds()/10|0)).slice(-2)},S:function(i){return""+(i.getMilliseconds()/100|0)},dddd:function(i){return this.res.dddd[i.getDay()]},ddd:function(i){return this.res.ddd[i.getDay()]},dd:function(i){return this.res.dd[i.getDay()]},Z:function(i){var t=i.getTimezoneOffset()/.6|0;return(t>0?"-":"+")+("000"+Math.abs(t-(t%100*.4|0))).slice(-4)},ZZ:function(i){var t=i.getTimezoneOffset(),e=Math.abs(t);return(t>0?"-":"+")+("0"+(e/60|0)).slice(-2)+":"+("0"+e%60).slice(-2)},post:function(i){return i},res:Et},ie={YYYY:function(i){return this.exec(/^\d{4}/,i)},Y:function(i){return this.exec(/^\d{1,4}/,i)},MMMM:function(i){var t=this.find(this.res.MMMM,i);return t.value++,t},MMM:function(i){var t=this.find(this.res.MMM,i);return t.value++,t},MM:function(i){return this.exec(/^\d\d/,i)},M:function(i){return this.exec(/^\d\d?/,i)},DD:function(i){return this.exec(/^\d\d/,i)},D:function(i){return this.exec(/^\d\d?/,i)},HH:function(i){return this.exec(/^\d\d/,i)},H:function(i){return this.exec(/^\d\d?/,i)},A:function(i){return this.find(this.res.A,i)},hh:function(i){return this.exec(/^\d\d/,i)},h:function(i){return this.exec(/^\d\d?/,i)},mm:function(i){return this.exec(/^\d\d/,i)},m:function(i){return this.exec(/^\d\d?/,i)},ss:function(i){return this.exec(/^\d\d/,i)},s:function(i){return this.exec(/^\d\d?/,i)},SSS:function(i){return this.exec(/^\d{1,3}/,i)},SS:function(i){var t=this.exec(/^\d\d?/,i);return t.value*=10,t},S:function(i){var t=this.exec(/^\d/,i);return t.value*=100,t},Z:function(i){var t=this.exec(/^[+-]\d{2}[0-5]\d/,i);return t.value=(t.value/100|0)*-60-t.value%100,t},ZZ:function(i){var t=/^([+-])(\d{2}):([0-5]\d)/.exec(i)||["","","",""];return{value:0-((t[1]+t[2]|0)*60+(t[1]+t[3]|0)),length:t[0].length}},h12:function(i,t){return(i===12?0:i)+t*12},exec:function(i,t){var e=(i.exec(t)||[""])[0];return{value:e|0,length:e.length}},find:function(i,t){for(var e=-1,s=0,r=0,n=i.length,o;r<n;r++)o=i[r],!t.indexOf(o)&&o.length>s&&(e=r,s=o.length);return{value:e,length:s}},pre:function(i){return i},res:Et},R=function(i,t,e,s){var r={},n;for(n in i)r[n]=i[n];for(n in t||{})!!e^!!r[n]||(r[n]=t[n]);return s&&(r.res=s),r},S={_formatter:ee,_parser:ie},x;S.compile=function(i){return[i].concat(i.match(/\[(?:[^[\]]|\[[^[\]]*])*]|([A-Za-z])\1*|\.{3}|./g)||[])};S.format=function(i,t,e){for(var s=this||x,r=typeof t=="string"?s.compile(t):t,n=s._formatter,o=function(){if(e){var c=new Date(i.getTime());return c.getFullYear=c.getUTCFullYear,c.getMonth=c.getUTCMonth,c.getDate=c.getUTCDate,c.getHours=c.getUTCHours,c.getMinutes=c.getUTCMinutes,c.getSeconds=c.getUTCSeconds,c.getMilliseconds=c.getUTCMilliseconds,c.getDay=c.getUTCDay,c.getTimezoneOffset=function(){return 0},c.getTimezoneName=function(){return"UTC"},c}return i}(),a=/^\[(.*)\]$/,h="",u=1,d=r.length,l;u<d;u++)l=r[u],h+=n[l]?n.post(n[l](o,r[0])):a.test(l)?l.replace(a,"$1"):l;return h};S.preparse=function(i,t){var e=this||x,s=typeof t=="string"?e.compile(t):t,r=e._parser,n={Y:1970,M:1,D:1,H:0,A:0,h:0,m:0,s:0,S:0,Z:0,_index:0,_length:0,_match:0},o=" ",a=/^\[(.*)\]$/,h="...";i=r.pre(i);for(var u=1,d=s.length,l,c,p;u<d;u++)if(l=s[u],c=i.substring(n._index),r[l]){if(p=r[l](c,s[0]),!p.length)break;n[p.token||l.charAt(0)]=p.value,n._index+=p.length,n._match++}else if(l===c.charAt(0)||l===o)n._index++;else if(a.test(l)&&!c.indexOf(l.replace(a,"$1")))n._index+=l.length-2;else if(l===h){n._index=i.length;break}else break;return n.H=n.H||r.h12(n.h,n.A),n._length=i.length,n};S.parse=function(i,t,e){var s=this||x,r=typeof t=="string"?s.compile(t):t,n=s.preparse(i,r);return s.isValid(n)?(n.M-=n.Y<100?22801:1,e||~s._parser.find(r,"ZZ").value?new Date(Date.UTC(n.Y,n.M,n.D,n.H,n.m+n.Z,n.s,n.S)):new Date(n.Y,n.M,n.D,n.H,n.m,n.s,n.S)):new Date(NaN)};S.isValid=function(i,t){var e=this||x,s=typeof i=="string"?e.preparse(i,t):i;return!(s._index<1||s._length<1||s._index-s._length||s._match<1||s.Y<1||s.Y>9999||s.M<1||s.M>12||s.D<1||s.D>new Date(s.Y,s.M,0).getDate()||s.H<0||s.H>23||s.m<0||s.m>59||s.s<0||s.s>59||s.S<0||s.S>999||s.Z<-840||s.Z>720)};S.transform=function(i,t,e,s){let r=this||x;return r.format(r.parse(i,t),e,s)};S.addYears=function(i,t,e){return(this||x).addMonths(i,t*12,e)};S.addMonths=function(i,t,e){var s=new Date(i.getTime());if(e){if(s.setUTCMonth(s.getUTCMonth()+t),s.getUTCDate()<i.getUTCDate())return s.setUTCDate(0),s}else if(s.setMonth(s.getMonth()+t),s.getDate()<i.getDate())return s.setDate(0),s;return s};S.addDays=function(i,t,e){var s=new Date(i.getTime());return e?s.setUTCDate(s.getUTCDate()+t):s.setDate(s.getDate()+t),s};S.addHours=function(i,t){return new Date(i.getTime()+t*60*60*1e3)};S.addMinutes=function(i,t){return new Date(i.getTime()+t*60*1e3)};S.addSeconds=function(i,t){return new Date(i.getTime()+t*1e3)};S.addMilliseconds=function(i,t){return new Date(i.getTime()+t)};S.subtract=function(i,t){var e=i.getTime()-t.getTime();return{toMilliseconds:function(){return e},toSeconds:function(){return e/1e3},toMinutes:function(){return e/6e4},toHours:function(){return e/36e5},toDays:function(){return e/864e5}}};S.isLeapYear=function(i){return!(i%4)&&!!(i%100)||!(i%400)};S.isSameDay=function(i,t){return i.toDateString()===t.toDateString()};S.locale=function(i,t){_t[i]||(_t[i]=t)};S.plugin=function(i,t){Z[i]||(Z[i]=t)};x=R(S);x.locale=function(i){var t=typeof i=="function"?i:x.locale[i];if(!t)return ct;ct=t(S);var e=_t[ct]||{},s=R(Et,e.res,!0),r=R(ee,e.formatter,!0,s),n=R(ie,e.parser,!0,s);x._formatter=r,x._parser=n;for(var o in Z)x.extend(Z[o]);return ct};x.extend=function(i){var t=R(x._parser.res,i.res),e=i.extender||{};x._formatter=R(x._formatter,i.formatter,!1,t),x._parser=R(x._parser,i.parser,!1,t);for(var s in e)x[s]||(x[s]=e[s])};x.plugin=function(i){var t=typeof i=="function"?i:x.plugin[i];t&&x.extend(Z[t(S,x)]||{})};var M=x;var oi=new Date("2025-01-01T00:00:00Z"),N=10002,se=N-1;function re(i=new Date){return new Date(i.setUTCHours(23,59,59,0))}function J(i=new Date){return Math.floor(M.subtract(i,oi).toDays())%N}function ut(i=new Date){return J(M.addDays(i,-1))}function ai(i,t){return(t-i+N)%N}function ne(i){if(isNaN(i)||i<0||i>N-1)throw new Error(`Index must be within [0, ${N-1}]`);let t=re(),e=J(t);if(i===e)return t;if(i===ut())return M.addDays(t,-1);let s=ai(e,i);return M.addDays(t,s)}function Ot(i,t=new Date){if(isNaN(i)||i<-1||i>se-1)throw new Error(`TTL must be within [-1, ${se-1}]`);return M.addDays(re(t),Math.floor(i))}function oe(i){let t=new Date;return i.getTime()<t.getTime()?0:M.subtract(i,t).toDays()}function ae(i){return i===ut()}var K=class i extends Map{inv;constructor(t,e){if(super(t),e)this.inv=e;else{let s=Array.from(this).map(([r,n])=>[n,r]);if(this.inv=new i(s,this),this.inv.size<s.length)throw new Error("Breaking bijection")}if(this.size!==this.inv.size)throw new Error("Breaking bijection")}delete(t){let e=this.get(t);return this.inv?.__delete(e),super.delete(t)}__delete(t){return super.delete(t)}set(t,e){if(this.inv?.has(e))throw new Error("Breaking bijection");return this.delete(t),this.inv?.__set(e,t),super.set(t,e)}regenInverseOf(){this.inv.__clear();for(let[t,e]of this.entries())this.inv.__set(e,t)}push(t,e){if(!this.inv?.has(e))return this.set(t,e);this.__delete(this.inv.get(e)),this.__set(t,e),this.regenInverseOf()}__set(t,e){return super.set(t,e)}clear(){return this.inv?.__clear(),super.clear()}__clear(){return super.clear()}};function H(){return typeof navigator=="object"&&"userAgent"in navigator?navigator.userAgent:typeof process=="object"&&process.version!==void 0?`Node.js/${process.version.substr(1)} (${process.platform}; ${process.arch})`:"<environment undetectable>"}var li="0.0.0-development",ci=`octokit-endpoint.js/${li} ${H()}`,ui={method:"GET",baseUrl:"https://api.github.com",headers:{accept:"application/vnd.github.v3+json","user-agent":ci},mediaType:{format:""}};function fi(i){return i?Object.keys(i).reduce((t,e)=>(t[e.toLowerCase()]=i[e],t),{}):{}}function di(i){if(typeof i!="object"||i===null||Object.prototype.toString.call(i)!=="[object Object]")return!1;let t=Object.getPrototypeOf(i);if(t===null)return!0;let e=Object.prototype.hasOwnProperty.call(t,"constructor")&&t.constructor;return typeof e=="function"&&e instanceof e&&Function.prototype.call(e)===Function.prototype.call(i)}function ce(i,t){let e=Object.assign({},i);return Object.keys(t).forEach(s=>{di(t[s])?s in i?e[s]=ce(i[s],t[s]):Object.assign(e,{[s]:t[s]}):Object.assign(e,{[s]:t[s]})}),e}function he(i){for(let t in i)i[t]===void 0&&delete i[t];return i}function Dt(i,t,e){if(typeof t=="string"){let[r,n]=t.split(" ");e=Object.assign(n?{method:r,url:n}:{url:r},e)}else e=Object.assign({},t);e.headers=fi(e.headers),he(e),he(e.headers);let s=ce(i||{},e);return e.url==="/graphql"&&(i&&i.mediaType.previews?.length&&(s.mediaType.previews=i.mediaType.previews.filter(r=>!s.mediaType.previews.includes(r)).concat(s.mediaType.previews)),s.mediaType.previews=(s.mediaType.previews||[]).map(r=>r.replace(/-preview/,""))),s}function pi(i,t){let e=/\?/.test(i)?"&":"?",s=Object.keys(t);return s.length===0?i:i+e+s.map(r=>r==="q"?"q="+t.q.split("+").map(encodeURIComponent).join("+"):`${r}=${encodeURIComponent(t[r])}`).join("&")}var mi=/\{[^{}}]+\}/g;function yi(i){return i.replace(/(?:^\W+)|(?:(?<!\W)\W+$)/g,"").split(/,/)}function gi(i){let t=i.match(mi);return t?t.map(yi).reduce((e,s)=>e.concat(s),[]):[]}function le(i,t){let e={__proto__:null};for(let s of Object.keys(i))t.indexOf(s)===-1&&(e[s]=i[s]);return e}function ue(i){return i.split(/(%[0-9A-Fa-f]{2})/g).map(function(t){return/%[0-9A-Fa-f]/.test(t)||(t=encodeURI(t).replace(/%5B/g,"[").replace(/%5D/g,"]")),t}).join("")}function W(i){return encodeURIComponent(i).replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})}function X(i,t,e){return t=i==="+"||i==="#"?ue(t):W(t),e?W(e)+"="+t:t}function I(i){return i!=null}function Ct(i){return i===";"||i==="&"||i==="?"}function wi(i,t,e,s){var r=i[e],n=[];if(I(r)&&r!=="")if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")r=r.toString(),s&&s!=="*"&&(r=r.substring(0,parseInt(s,10))),n.push(X(t,r,Ct(t)?e:""));else if(s==="*")Array.isArray(r)?r.filter(I).forEach(function(o){n.push(X(t,o,Ct(t)?e:""))}):Object.keys(r).forEach(function(o){I(r[o])&&n.push(X(t,r[o],o))});else{let o=[];Array.isArray(r)?r.filter(I).forEach(function(a){o.push(X(t,a))}):Object.keys(r).forEach(function(a){I(r[a])&&(o.push(W(a)),o.push(X(t,r[a].toString())))}),Ct(t)?n.push(W(e)+"="+o.join(",")):o.length!==0&&n.push(o.join(","))}else t===";"?I(r)&&n.push(W(e)):r===""&&(t==="&"||t==="?")?n.push(W(e)+"="):r===""&&n.push("");return n}function bi(i){return{expand:xi.bind(null,i)}}function xi(i,t){var e=["+","#",".","/",";","?","&"];return i=i.replace(/\{([^\{\}]+)\}|([^\{\}]+)/g,function(s,r,n){if(r){let a="",h=[];if(e.indexOf(r.charAt(0))!==-1&&(a=r.charAt(0),r=r.substr(1)),r.split(/,/g).forEach(function(u){var d=/([^:\*]*)(?::(\d+)|(\*))?/.exec(u);h.push(wi(t,a,d[1],d[2]||d[3]))}),a&&a!=="+"){var o=",";return a==="?"?o="&":a!=="#"&&(o=a),(h.length!==0?a:"")+h.join(o)}else return h.join(",")}else return ue(n)}),i==="/"?i:i.replace(/\/$/,"")}function fe(i){let t=i.method.toUpperCase(),e=(i.url||"/").replace(/:([a-z]\w+)/g,"{$1}"),s=Object.assign({},i.headers),r,n=le(i,["method","baseUrl","url","headers","request","mediaType"]),o=gi(e);e=bi(e).expand(n),/^http/.test(e)||(e=i.baseUrl+e);let a=Object.keys(i).filter(d=>o.includes(d)).concat("baseUrl"),h=le(n,a);if(!/application\/octet-stream/i.test(s.accept)&&(i.mediaType.format&&(s.accept=s.accept.split(/,/).map(d=>d.replace(/application\/vnd(\.\w+)(\.v3)?(\.\w+)?(\+json)?$/,`application/vnd$1$2.${i.mediaType.format}`)).join(",")),e.endsWith("/graphql")&&i.mediaType.previews?.length)){let d=s.accept.match(/(?<![\w-])[\w-]+(?=-preview)/g)||[];s.accept=d.concat(i.mediaType.previews).map(l=>{let c=i.mediaType.format?`.${i.mediaType.format}`:"+json";return`application/vnd.github.${l}-preview${c}`}).join(",")}return["GET","HEAD"].includes(t)?e=pi(e,h):"data"in h?r=h.data:Object.keys(h).length&&(r=h),!s["content-type"]&&typeof r<"u"&&(s["content-type"]="application/json; charset=utf-8"),["PATCH","PUT"].includes(t)&&typeof r>"u"&&(r=""),Object.assign({method:t,url:e,headers:s},typeof r<"u"?{body:r}:null,i.request?{request:i.request}:null)}function Ti(i,t,e){return fe(Dt(i,t,e))}function de(i,t){let e=Dt(i,t),s=Ti.bind(null,e);return Object.assign(s,{DEFAULTS:e,defaults:de.bind(null,e),merge:Dt.bind(null,e),parse:fe})}var pe=de(null,ui);var xe=We(we(),1);var z=class extends Error{name;status;request;response;constructor(t,e,s){super(t),this.name="HttpError",this.status=Number.parseInt(e),Number.isNaN(this.status)&&(this.status=0),"response"in s&&(this.response=s.response);let r=Object.assign({},s.request);s.request.headers.authorization&&(r.headers=Object.assign({},s.request.headers,{authorization:s.request.headers.authorization.replace(/(?<! ) .*$/," [REDACTED]")})),r.url=r.url.replace(/\bclient_secret=\w+/g,"client_secret=[REDACTED]").replace(/\baccess_token=\w+/g,"access_token=[REDACTED]"),this.request=r}};var vi="0.0.0-development",Si={headers:{"user-agent":`octokit-request.js/${vi} ${H()}`}};function Ai(i){if(typeof i!="object"||i===null||Object.prototype.toString.call(i)!=="[object Object]")return!1;let t=Object.getPrototypeOf(i);if(t===null)return!0;let e=Object.prototype.hasOwnProperty.call(t,"constructor")&&t.constructor;return typeof e=="function"&&e instanceof e&&Function.prototype.call(e)===Function.prototype.call(i)}async function be(i){let t=i.request?.fetch||globalThis.fetch;if(!t)throw new Error("fetch is not set. Please pass a fetch implementation as new Octokit({ request: { fetch }}). Learn more at https://github.com/octokit/octokit.js/#fetch-missing");let e=i.request?.log||console,s=i.request?.parseSuccessResponseBody!==!1,r=Ai(i.body)||Array.isArray(i.body)?JSON.stringify(i.body):i.body,n=Object.fromEntries(Object.entries(i.headers).map(([l,c])=>[l,String(c)])),o;try{o=await t(i.url,{method:i.method,body:r,redirect:i.request?.redirect,headers:n,signal:i.request?.signal,...i.body&&{duplex:"half"}})}catch(l){let c="Unknown Error";if(l instanceof Error){if(l.name==="AbortError")throw l.status=500,l;c=l.message,l.name==="TypeError"&&"cause"in l&&(l.cause instanceof Error?c=l.cause.message:typeof l.cause=="string"&&(c=l.cause))}let p=new z(c,500,{request:i});throw p.cause=l,p}let a=o.status,h=o.url,u={};for(let[l,c]of o.headers)u[l]=c;let d={url:h,status:a,headers:u,data:""};if("deprecation"in u){let l=u.link&&u.link.match(/<([^<>]+)>; rel="deprecation"/),c=l&&l.pop();e.warn(`[@octokit/request] "${i.method} ${i.url}" is deprecated. It is scheduled to be removed on ${u.sunset}${c?`. See ${c}`:""}`)}if(a===204||a===205)return d;if(i.method==="HEAD"){if(a<400)return d;throw new z(o.statusText,a,{response:d,request:i})}if(a===304)throw d.data=await Ft(o),new z("Not modified",a,{response:d,request:i});if(a>=400)throw d.data=await Ft(o),new z(Ei(d.data),a,{response:d,request:i});return d.data=s?await Ft(o):o.body,d}async function Ft(i){let t=i.headers.get("content-type");if(!t)return i.text().catch(()=>"");let e=(0,xe.safeParse)(t);if(_i(e)){let s="";try{return s=await i.text(),JSON.parse(s)}catch{return s}}else return e.type.startsWith("text/")||e.parameters.charset?.toLowerCase()==="utf-8"?i.text().catch(()=>""):i.arrayBuffer().catch(()=>new ArrayBuffer(0))}function _i(i){return i.type==="application/json"||i.type==="application/scim+json"}function Ei(i){if(typeof i=="string")return i;if(i instanceof ArrayBuffer)return"Unknown error";if("message"in i){let t="documentation_url"in i?` - ${i.documentation_url}`:"";return Array.isArray(i.errors)?`${i.message}: ${i.errors.map(e=>JSON.stringify(e)).join(", ")}${t}`:`${i.message}${t}`}return`Unknown error: ${JSON.stringify(i)}`}function Ut(i,t){let e=i.defaults(t);return Object.assign(function(r,n){let o=e.merge(r,n);if(!o.request||!o.request.hook)return be(e.parse(o));let a=(h,u)=>be(e.parse(e.merge(h,u)));return Object.assign(a,{endpoint:e,defaults:Ut.bind(null,e)}),o.request.hook(a,o)},{endpoint:e,defaults:Ut.bind(null,e)})}var mt=Ut(pe,Si);var Oi="0.0.0-development";function Ci(i){return`Request failed due to following response errors:
`+i.errors.map(t=>` - ${t.message}`).join(`
`)}var Di=class extends Error{constructor(i,t,e){super(Ci(e)),this.request=i,this.headers=t,this.response=e,this.errors=e.errors,this.data=e.data,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}name="GraphqlResponseError";errors;data},Fi=["method","baseUrl","url","headers","request","query","mediaType","operationName"],Ui=["query","method","url"],Te=/\/api\/v3\/?$/;function Ri(i,t,e){if(e){if(typeof t=="string"&&"query"in e)return Promise.reject(new Error('[@octokit/graphql] "query" cannot be used as variable name'));for(let o in e)if(Ui.includes(o))return Promise.reject(new Error(`[@octokit/graphql] "${o}" cannot be used as variable name`))}let s=typeof t=="string"?Object.assign({query:t},e):t,r=Object.keys(s).reduce((o,a)=>Fi.includes(a)?(o[a]=s[a],o):(o.variables||(o.variables={}),o.variables[a]=s[a],o),{}),n=s.baseUrl||i.endpoint.DEFAULTS.baseUrl;return Te.test(n)&&(r.url=n.replace(Te,"/api/graphql")),i(r).then(o=>{if(o.data.errors){let a={};for(let h of Object.keys(o.headers))a[h]=o.headers[h];throw new Di(r,a,o.data)}return o.data.data})}function Rt(i,t){let e=i.defaults(t);return Object.assign((r,n)=>Ri(e,r,n),{defaults:Rt.bind(null,e),endpoint:e.endpoint})}var ps=Rt(mt,{headers:{"user-agent":`octokit-graphql.js/${Oi} ${H()}`},method:"POST",url:"/graphql"});function ve(i){return Rt(i,{method:"POST",url:"/graphql"})}async function Se(i,t="SHA-256"){return crypto.subtle.digest(t,i).then(e=>new Uint8Array(e))}async function $t(i,t="blob",e="SHA-1"){let s=await at([C(`${t} ${i.length}\0`),i]);return Tt(await Se(s,e))}async function _e(i){let t;switch(B(i)){case"Number":case"Boolean":case"String":t=C(i.toString());break;case"Array":case"Object":t=C(JSON.stringify(i));break;case"Uint8Array":t=i;break;case"ArrayBuffer":t=new Uint8Array(i);break;default:throw new Error("Unsupported parameter type")}return $t(t)}var Mt={tree:"40000",blob:"100644",file:"100644",exec:"100755",sym:"120000",commit:"160000"};function Mi(i){let t=this[i];return{name:i,mode:Mt[t.type],hash:t.hash}}function $i(i,t){let e=i.mode===Mt.tree?i.name+"/":i.name,s=t.mode===Mt.tree?t.name+"/":t.name;return e>s?1:e<s?-1:0}async function Ee(i){let t=Object.keys(i).map(Mi,i).sort($i),e=[];for(let r of t)e.push(C(`${r.mode} ${r.name}\0`),vt(r.hash));let s=await at(e);return $t(s,"tree")}function zi(i){return`${Math.floor(i.getTime()/1e3)} +0000`}function Ae({name:i,email:t,date:e}){let s=isNaN(Date.parse(e))?e:zi(new Date(e));return`${i} <${t}> ${s}`}async function Oe({treeHash:i,parentCommitHashes:t=[],message:e="",author:s,committer:r}){e&&!e.endsWith(`
`)&&(e+=`
`);let n;return n=t.reduce((o,a)=>`${o}
parent ${a}`,`tree ${i}`),n+=`
author ${Ae(s)}`,n+=`
committer ${Ae(r)}`,n+=`
`,n+=`
${e}`,$t(C(n),"commit")}var tt=class i{committer;author;owner;name;authenticated;request;graphql;ratelimit={};id;isPublic;created;async encrypt(t){return t}async decrypt(t){return t}encrypted=!1;static async instantiate(...t){let e=new i(...t);return await e.#n(),e}constructor(t,{auth:e,encrypt:s,decrypt:r,committer:n,author:o,fetch:a=globalThis.fetch}={}){let[h,u]=t.split("/");this.owner=h,this.name=u,this.authenticated=!!e,s&&(this.encrypt=s),r&&(this.decrypt=r),(s||r)&&(this.encrypted=!0),this.committer=n??o??{},this.author=o??this.committer;let d=this.ratelimit;this.request=mt.defaults({owner:h,repo:u,headers:{Authorization:e?`Bearer ${e}`:void 0,"X-GitHub-Api-Version":"2022-11-28"},request:{fetch:async(...l)=>{if(d.remaining===0&&new Date().getTime()/1e3<d.reset)return new Response(`Ratelimited. Try after ${new Date(d.reset*1e3)}.`,{status:429,statusText:"Too Many Requests"});let c=await a(...l),p=c.headers;return d.reset=p.get("x-ratelimit-reset")??void 0,d.used=p.get("x-ratelimit-used")??void 0,d.remaining=p.get("x-ratelimit-remaining")??void 0,d["retry-after"]=p.get("retry-after")??void 0,c}}}),this.graphql=ve(this.request)}async#n(){let{node_id:t,visibility:e,created_at:s}=await this.request("GET /repos/{owner}/{repo}").then(r=>r.data);this.id=t,this.isPublic=e==="public",this.created=new Date(s).getTime()}async hasCommit(t){return this.request("HEAD /repos/{owner}/{repo}/git/commits/{commitHash}",{commitHash:t}).then(()=>!0).catch(e=>{if(e.status===404)return!1;throw new Error(`GitHub API network error: ${e.status}`,{cause:e})})}async hasRef(t){return t.startsWith("refs/")?t=t.substring(5):t=`heads/${t}`,this.request("HEAD /repos/{owner}/{repo}/git/ref/{ref}",{ref:t}).then(()=>!0).catch(e=>{if(e.status===404)return!1;throw new Error(`GitHub API network error: ${e.status}`,{cause:e})})}async commitBytes(t,{message:e="",encrypt:s=this.encrypted,paths:r=["bytes"],author:n={...this.author},committer:o=structuredClone(this.committer),parentCommitHashes:a=[],push:h=!0}={}){e&&!e.endsWith(`
`)&&(e+=`
`),o.date===void 0&&(o.date=new Date().toISOString()),n.date===void 0&&(n.date=o.date);let u=s?await this.encrypt(t):t,d=await _e(u),l={},c=[];for(let f of r)l[f]={type:"blob",hash:d},c.push({path:f,type:"blob",mode:"100644",sha:d});let p=await Ee(l),b=await Oe({treeHash:p,message:e,committer:o,author:n,parentCommitHashes:a});if(!h||await this.hasCommit(b))return b;let m=Wt(u);await this.request("POST /repos/{owner}/{repo}/git/blobs",{content:m,encoding:"base64"}),await this.request("POST /repos/{owner}/{repo}/git/trees",{tree:c});let w=await this.request("POST /repos/{owner}/{repo}/git/commits",{message:e,tree:p,author:n,committer:o,parents:a}).then(f=>f.data.sha);if(b!==w)throw new Error(`Upstream commit hash ${w} doesn't match locally computed ${b}`);return w}async updateRefs([...t]){let e="0000000000000000000000000000000000000000";for(let s of t){let{name:r,beforeOid:n,afterOid:o,force:a}=s;r.startsWith("refs/")||(s.name=`refs/heads/${r}`),n===null&&(s.beforeOid=e),s.afterOid=o??e,s.force=a??!0}await this.graphql(`
    mutation($repositoryId: ID!, $refUpdates: [RefUpdate!]!) {
      updateRefs(input: { repositoryId: $repositoryId, refUpdates: $refUpdates }) {
        clientMutationId
      }
    }
  `,{repositoryId:this.id,refUpdates:t})}async refToCommitHash(t){return t.startsWith("refs/")?t=t.substring(5):t=`heads/${t}`,this.request("GET /repos/{owner}/{repo}/git/ref/{ref}",{ref:t}).then(e=>e.data.object.sha).catch(e=>{if(e.status!==404)throw e})}async fetchBlobContent(t,{decrypt:e=this.encrypted}={}){return this.request("GET /repos/{owner}/{repo}/git/blobs/{blobHash}",{blobHash:t}).then(s=>ot(s.data.content)).catch(s=>{if(s.status!==404)throw s}).then(s=>e?this.decrypt(s):s)}async fetchCommitContent(t,{decrypt:e=this.encrypted,path:s="bytes"}={}){if(!this.isPublic)return this.request("GET /repos/{owner}/{repo}/contents/{path}",{path:s,ref:t}).then(r=>r.data.sha).catch(r=>{if(r.status!==404)throw r}).then(r=>this.fetchBlobContent(r,{decrypt:e}));for(let r of this.cdnLinks(t,s))try{let n=await fetch(r,{redirect:"follow"}).then(o=>{if(!o.ok)throw new Error(o.status);return o.bytes()});return e?this.decrypt(n):n}catch(n){if(n.message==="404")return;continue}throw new Error("Unexpected failure with CDNs")}async fetchCommitMessage(t){return this.request("GET /repos/{owner}/{repo}/git/commits/{ref}",{ref:t}).then(e=>e.data.message).catch(e=>{if(e.status!==404)throw e})}cdnLinks(t,e="bytes"){if(typeof e!="string"||e.startsWith("./"))throw new Error("Pass proper path parameter");if(!this.isPublic)return[];let s=this.owner,r=this.name;return[`https://cdn.jsdelivr.net/gh/${s}/${r}@${t}/${e}`,`https://cdn.statically.io/gh/${s}/${r}/${t}/${e}`,`https://rawcdn.githack.com/${s}/${r}/${t}/${e}`,`https://esm.sh/gh/${s}/${r}@${t}/${e}`,`https://raw.githubusercontent.com/${s}/${r}/${t}/${e}`]}async listBranchesTo(t){return(await this.request("GET /repos/{owner}/{repo}/commits/{commitHash}/branches-where-head",{commitHash:t}).then(s=>s.data)).map(s=>s.name)}};var L=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,De=new Set,zt=typeof process=="object"&&process?process:{},Fe=(i,t,e,s)=>{typeof zt.emitWarning=="function"?zt.emitWarning(i,t,e,s):console.error(`[${e}] ${t}: ${i}`)},yt=globalThis.AbortController,Ce=globalThis.AbortSignal;if(typeof yt>"u"){Ce=class{onabort;_onabort=[];reason;aborted=!1;addEventListener(s,r){this._onabort.push(r)}},yt=class{constructor(){t()}signal=new Ce;abort(s){if(!this.signal.aborted){this.signal.reason=s,this.signal.aborted=!0;for(let r of this.signal._onabort)r(s);this.signal.onabort?.(s)}}};let i=zt.env?.LRU_CACHE_IGNORE_AC_WARNING!=="1",t=()=>{i&&(i=!1,Fe("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",t))}}var Bi=i=>!De.has(i),Cs=Symbol("type"),F=i=>i&&i===Math.floor(i)&&i>0&&isFinite(i),Ue=i=>F(i)?i<=Math.pow(2,8)?Uint8Array:i<=Math.pow(2,16)?Uint16Array:i<=Math.pow(2,32)?Uint32Array:i<=Number.MAX_SAFE_INTEGER?q:null:null,q=class extends Array{constructor(t){super(t),this.fill(0)}},jt=class i{heap;length;static#n=!1;static create(t){let e=Ue(t);if(!e)return[];i.#n=!0;let s=new i(t,e);return i.#n=!1,s}constructor(t,e){if(!i.#n)throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new e(t),this.length=0}push(t){this.heap[this.length++]=t}pop(){return this.heap[--this.length]}},et=class i{#n;#u;#m;#O;#y;#U;#R;ttl;ttlResolution;ttlAutopurge;updateAgeOnGet;updateAgeOnHas;allowStale;noDisposeOnSet;noUpdateTTL;maxEntrySize;sizeCalculation;noDeleteOnFetchRejection;noDeleteOnStaleGet;allowStaleOnFetchAbort;allowStaleOnFetchRejection;ignoreFetchAbort;#r;#g;#s;#i;#t;#l;#f;#h;#o;#w;#a;#b;#x;#d;#T;#E;#c;#M;static unsafeExposeInternals(t){return{starts:t.#x,ttls:t.#d,sizes:t.#b,keyMap:t.#s,keyList:t.#i,valList:t.#t,next:t.#l,prev:t.#f,get head(){return t.#h},get tail(){return t.#o},free:t.#w,isBackgroundFetch:e=>t.#e(e),backgroundFetch:(e,s,r,n)=>t.#j(e,s,r,n),moveToTail:e=>t.#F(e),indexes:e=>t.#v(e),rindexes:e=>t.#S(e),isStale:e=>t.#p(e)}}get max(){return this.#n}get maxSize(){return this.#u}get calculatedSize(){return this.#g}get size(){return this.#r}get fetchMethod(){return this.#U}get memoMethod(){return this.#R}get dispose(){return this.#m}get onInsert(){return this.#O}get disposeAfter(){return this.#y}constructor(t){let{max:e=0,ttl:s,ttlResolution:r=1,ttlAutopurge:n,updateAgeOnGet:o,updateAgeOnHas:a,allowStale:h,dispose:u,onInsert:d,disposeAfter:l,noDisposeOnSet:c,noUpdateTTL:p,maxSize:b=0,maxEntrySize:m=0,sizeCalculation:w,fetchMethod:f,memoMethod:y,noDeleteOnFetchRejection:v,noDeleteOnStaleGet:g,allowStaleOnFetchRejection:T,allowStaleOnFetchAbort:E,ignoreFetchAbort:A}=t;if(e!==0&&!F(e))throw new TypeError("max option must be a nonnegative integer");let O=e?Ue(e):Array;if(!O)throw new Error("invalid max value: "+e);if(this.#n=e,this.#u=b,this.maxEntrySize=m||this.#u,this.sizeCalculation=w,this.sizeCalculation){if(!this.#u&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(y!==void 0&&typeof y!="function")throw new TypeError("memoMethod must be a function if defined");if(this.#R=y,f!==void 0&&typeof f!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.#U=f,this.#E=!!f,this.#s=new Map,this.#i=new Array(e).fill(void 0),this.#t=new Array(e).fill(void 0),this.#l=new O(e),this.#f=new O(e),this.#h=0,this.#o=0,this.#w=jt.create(e),this.#r=0,this.#g=0,typeof u=="function"&&(this.#m=u),typeof d=="function"&&(this.#O=d),typeof l=="function"?(this.#y=l,this.#a=[]):(this.#y=void 0,this.#a=void 0),this.#T=!!this.#m,this.#M=!!this.#O,this.#c=!!this.#y,this.noDisposeOnSet=!!c,this.noUpdateTTL=!!p,this.noDeleteOnFetchRejection=!!v,this.allowStaleOnFetchRejection=!!T,this.allowStaleOnFetchAbort=!!E,this.ignoreFetchAbort=!!A,this.maxEntrySize!==0){if(this.#u!==0&&!F(this.#u))throw new TypeError("maxSize must be a positive integer if specified");if(!F(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.#q()}if(this.allowStale=!!h,this.noDeleteOnStaleGet=!!g,this.updateAgeOnGet=!!o,this.updateAgeOnHas=!!a,this.ttlResolution=F(r)||r===0?r:1,this.ttlAutopurge=!!n,this.ttl=s||0,this.ttl){if(!F(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.#B()}if(this.#n===0&&this.ttl===0&&this.#u===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.#n&&!this.#u){let _="LRU_CACHE_UNBOUNDED";Bi(_)&&(De.add(_),Fe("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",_,i))}}getRemainingTTL(t){return this.#s.has(t)?1/0:0}#B(){let t=new q(this.#n),e=new q(this.#n);this.#d=t,this.#x=e,this.#N=(n,o,a=L.now())=>{if(e[n]=o!==0?a:0,t[n]=o,o!==0&&this.ttlAutopurge){let h=setTimeout(()=>{this.#p(n)&&this.#A(this.#i[n],"expire")},o+1);h.unref&&h.unref()}},this.#C=n=>{e[n]=t[n]!==0?L.now():0},this.#_=(n,o)=>{if(t[o]){let a=t[o],h=e[o];if(!a||!h)return;n.ttl=a,n.start=h,n.now=s||r();let u=n.now-h;n.remainingTTL=a-u}};let s=0,r=()=>{let n=L.now();if(this.ttlResolution>0){s=n;let o=setTimeout(()=>s=0,this.ttlResolution);o.unref&&o.unref()}return n};this.getRemainingTTL=n=>{let o=this.#s.get(n);if(o===void 0)return 0;let a=t[o],h=e[o];if(!a||!h)return 1/0;let u=(s||r())-h;return a-u},this.#p=n=>{let o=e[n],a=t[n];return!!a&&!!o&&(s||r())-o>a}}#C=()=>{};#_=()=>{};#N=()=>{};#p=()=>!1;#q(){let t=new q(this.#n);this.#g=0,this.#b=t,this.#D=e=>{this.#g-=t[e],t[e]=0},this.#H=(e,s,r,n)=>{if(this.#e(s))return 0;if(!F(r))if(n){if(typeof n!="function")throw new TypeError("sizeCalculation must be a function");if(r=n(s,e),!F(r))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return r},this.#$=(e,s,r)=>{if(t[e]=s,this.#u){let n=this.#u-t[e];for(;this.#g>n;)this.#z(!0)}this.#g+=t[e],r&&(r.entrySize=s,r.totalCalculatedSize=this.#g)}}#D=t=>{};#$=(t,e,s)=>{};#H=(t,e,s,r)=>{if(s||r)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0};*#v({allowStale:t=this.allowStale}={}){if(this.#r)for(let e=this.#o;!(!this.#I(e)||((t||!this.#p(e))&&(yield e),e===this.#h));)e=this.#f[e]}*#S({allowStale:t=this.allowStale}={}){if(this.#r)for(let e=this.#h;!(!this.#I(e)||((t||!this.#p(e))&&(yield e),e===this.#o));)e=this.#l[e]}#I(t){return t!==void 0&&this.#s.get(this.#i[t])===t}*entries(){for(let t of this.#v())this.#t[t]!==void 0&&this.#i[t]!==void 0&&!this.#e(this.#t[t])&&(yield[this.#i[t],this.#t[t]])}*rentries(){for(let t of this.#S())this.#t[t]!==void 0&&this.#i[t]!==void 0&&!this.#e(this.#t[t])&&(yield[this.#i[t],this.#t[t]])}*keys(){for(let t of this.#v()){let e=this.#i[t];e!==void 0&&!this.#e(this.#t[t])&&(yield e)}}*rkeys(){for(let t of this.#S()){let e=this.#i[t];e!==void 0&&!this.#e(this.#t[t])&&(yield e)}}*values(){for(let t of this.#v())this.#t[t]!==void 0&&!this.#e(this.#t[t])&&(yield this.#t[t])}*rvalues(){for(let t of this.#S())this.#t[t]!==void 0&&!this.#e(this.#t[t])&&(yield this.#t[t])}[Symbol.iterator](){return this.entries()}[Symbol.toStringTag]="LRUCache";find(t,e={}){for(let s of this.#v()){let r=this.#t[s],n=this.#e(r)?r.__staleWhileFetching:r;if(n!==void 0&&t(n,this.#i[s],this))return this.get(this.#i[s],e)}}forEach(t,e=this){for(let s of this.#v()){let r=this.#t[s],n=this.#e(r)?r.__staleWhileFetching:r;n!==void 0&&t.call(e,n,this.#i[s],this)}}rforEach(t,e=this){for(let s of this.#S()){let r=this.#t[s],n=this.#e(r)?r.__staleWhileFetching:r;n!==void 0&&t.call(e,n,this.#i[s],this)}}purgeStale(){let t=!1;for(let e of this.#S({allowStale:!0}))this.#p(e)&&(this.#A(this.#i[e],"expire"),t=!0);return t}info(t){let e=this.#s.get(t);if(e===void 0)return;let s=this.#t[e],r=this.#e(s)?s.__staleWhileFetching:s;if(r===void 0)return;let n={value:r};if(this.#d&&this.#x){let o=this.#d[e],a=this.#x[e];if(o&&a){let h=o-(L.now()-a);n.ttl=h,n.start=Date.now()}}return this.#b&&(n.size=this.#b[e]),n}dump(){let t=[];for(let e of this.#v({allowStale:!0})){let s=this.#i[e],r=this.#t[e],n=this.#e(r)?r.__staleWhileFetching:r;if(n===void 0||s===void 0)continue;let o={value:n};if(this.#d&&this.#x){o.ttl=this.#d[e];let a=L.now()-this.#x[e];o.start=Math.floor(Date.now()-a)}this.#b&&(o.size=this.#b[e]),t.unshift([s,o])}return t}load(t){this.clear();for(let[e,s]of t){if(s.start){let r=Date.now()-s.start;s.start=L.now()-r}this.set(e,s.value,s)}}set(t,e,s={}){if(e===void 0)return this.delete(t),this;let{ttl:r=this.ttl,start:n,noDisposeOnSet:o=this.noDisposeOnSet,sizeCalculation:a=this.sizeCalculation,status:h}=s,{noUpdateTTL:u=this.noUpdateTTL}=s,d=this.#H(t,e,s.size||0,a);if(this.maxEntrySize&&d>this.maxEntrySize)return h&&(h.set="miss",h.maxEntrySizeExceeded=!0),this.#A(t,"set"),this;let l=this.#r===0?void 0:this.#s.get(t);if(l===void 0)l=this.#r===0?this.#o:this.#w.length!==0?this.#w.pop():this.#r===this.#n?this.#z(!1):this.#r,this.#i[l]=t,this.#t[l]=e,this.#s.set(t,l),this.#l[this.#o]=l,this.#f[l]=this.#o,this.#o=l,this.#r++,this.#$(l,d,h),h&&(h.set="add"),u=!1,this.#M&&this.#O?.(e,t,"add");else{this.#F(l);let c=this.#t[l];if(e!==c){if(this.#E&&this.#e(c)){c.__abortController.abort(new Error("replaced"));let{__staleWhileFetching:p}=c;p!==void 0&&!o&&(this.#T&&this.#m?.(p,t,"set"),this.#c&&this.#a?.push([p,t,"set"]))}else o||(this.#T&&this.#m?.(c,t,"set"),this.#c&&this.#a?.push([c,t,"set"]));if(this.#D(l),this.#$(l,d,h),this.#t[l]=e,h){h.set="replace";let p=c&&this.#e(c)?c.__staleWhileFetching:c;p!==void 0&&(h.oldValue=p)}}else h&&(h.set="update");this.#M&&this.onInsert?.(e,t,e===c?"update":"replace")}if(r!==0&&!this.#d&&this.#B(),this.#d&&(u||this.#N(l,r,n),h&&this.#_(h,l)),!o&&this.#c&&this.#a){let c=this.#a,p;for(;p=c?.shift();)this.#y?.(...p)}return this}pop(){try{for(;this.#r;){let t=this.#t[this.#h];if(this.#z(!0),this.#e(t)){if(t.__staleWhileFetching)return t.__staleWhileFetching}else if(t!==void 0)return t}}finally{if(this.#c&&this.#a){let t=this.#a,e;for(;e=t?.shift();)this.#y?.(...e)}}}#z(t){let e=this.#h,s=this.#i[e],r=this.#t[e];return this.#E&&this.#e(r)?r.__abortController.abort(new Error("evicted")):(this.#T||this.#c)&&(this.#T&&this.#m?.(r,s,"evict"),this.#c&&this.#a?.push([r,s,"evict"])),this.#D(e),t&&(this.#i[e]=void 0,this.#t[e]=void 0,this.#w.push(e)),this.#r===1?(this.#h=this.#o=0,this.#w.length=0):this.#h=this.#l[e],this.#s.delete(s),this.#r--,e}has(t,e={}){let{updateAgeOnHas:s=this.updateAgeOnHas,status:r}=e,n=this.#s.get(t);if(n!==void 0){let o=this.#t[n];if(this.#e(o)&&o.__staleWhileFetching===void 0)return!1;if(this.#p(n))r&&(r.has="stale",this.#_(r,n));else return s&&this.#C(n),r&&(r.has="hit",this.#_(r,n)),!0}else r&&(r.has="miss");return!1}peek(t,e={}){let{allowStale:s=this.allowStale}=e,r=this.#s.get(t);if(r===void 0||!s&&this.#p(r))return;let n=this.#t[r];return this.#e(n)?n.__staleWhileFetching:n}#j(t,e,s,r){let n=e===void 0?void 0:this.#t[e];if(this.#e(n))return n;let o=new yt,{signal:a}=s;a?.addEventListener("abort",()=>o.abort(a.reason),{signal:o.signal});let h={signal:o.signal,options:s,context:r},u=(m,w=!1)=>{let{aborted:f}=o.signal,y=s.ignoreFetchAbort&&m!==void 0;if(s.status&&(f&&!w?(s.status.fetchAborted=!0,s.status.fetchError=o.signal.reason,y&&(s.status.fetchAbortIgnored=!0)):s.status.fetchResolved=!0),f&&!y&&!w)return l(o.signal.reason);let v=p;return this.#t[e]===p&&(m===void 0?v.__staleWhileFetching?this.#t[e]=v.__staleWhileFetching:this.#A(t,"fetch"):(s.status&&(s.status.fetchUpdated=!0),this.set(t,m,h.options))),m},d=m=>(s.status&&(s.status.fetchRejected=!0,s.status.fetchError=m),l(m)),l=m=>{let{aborted:w}=o.signal,f=w&&s.allowStaleOnFetchAbort,y=f||s.allowStaleOnFetchRejection,v=y||s.noDeleteOnFetchRejection,g=p;if(this.#t[e]===p&&(!v||g.__staleWhileFetching===void 0?this.#A(t,"fetch"):f||(this.#t[e]=g.__staleWhileFetching)),y)return s.status&&g.__staleWhileFetching!==void 0&&(s.status.returnedStale=!0),g.__staleWhileFetching;if(g.__returned===g)throw m},c=(m,w)=>{let f=this.#U?.(t,n,h);f&&f instanceof Promise&&f.then(y=>m(y===void 0?void 0:y),w),o.signal.addEventListener("abort",()=>{(!s.ignoreFetchAbort||s.allowStaleOnFetchAbort)&&(m(void 0),s.allowStaleOnFetchAbort&&(m=y=>u(y,!0)))})};s.status&&(s.status.fetchDispatched=!0);let p=new Promise(c).then(u,d),b=Object.assign(p,{__abortController:o,__staleWhileFetching:n,__returned:void 0});return e===void 0?(this.set(t,b,{...h.options,status:void 0}),e=this.#s.get(t)):this.#t[e]=b,b}#e(t){if(!this.#E)return!1;let e=t;return!!e&&e instanceof Promise&&e.hasOwnProperty("__staleWhileFetching")&&e.__abortController instanceof yt}async fetch(t,e={}){let{allowStale:s=this.allowStale,updateAgeOnGet:r=this.updateAgeOnGet,noDeleteOnStaleGet:n=this.noDeleteOnStaleGet,ttl:o=this.ttl,noDisposeOnSet:a=this.noDisposeOnSet,size:h=0,sizeCalculation:u=this.sizeCalculation,noUpdateTTL:d=this.noUpdateTTL,noDeleteOnFetchRejection:l=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:c=this.allowStaleOnFetchRejection,ignoreFetchAbort:p=this.ignoreFetchAbort,allowStaleOnFetchAbort:b=this.allowStaleOnFetchAbort,context:m,forceRefresh:w=!1,status:f,signal:y}=e;if(!this.#E)return f&&(f.fetch="get"),this.get(t,{allowStale:s,updateAgeOnGet:r,noDeleteOnStaleGet:n,status:f});let v={allowStale:s,updateAgeOnGet:r,noDeleteOnStaleGet:n,ttl:o,noDisposeOnSet:a,size:h,sizeCalculation:u,noUpdateTTL:d,noDeleteOnFetchRejection:l,allowStaleOnFetchRejection:c,allowStaleOnFetchAbort:b,ignoreFetchAbort:p,status:f,signal:y},g=this.#s.get(t);if(g===void 0){f&&(f.fetch="miss");let T=this.#j(t,g,v,m);return T.__returned=T}else{let T=this.#t[g];if(this.#e(T)){let wt=s&&T.__staleWhileFetching!==void 0;return f&&(f.fetch="inflight",wt&&(f.returnedStale=!0)),wt?T.__staleWhileFetching:T.__returned=T}let E=this.#p(g);if(!w&&!E)return f&&(f.fetch="hit"),this.#F(g),r&&this.#C(g),f&&this.#_(f,g),T;let A=this.#j(t,g,v,m),_=A.__staleWhileFetching!==void 0&&s;return f&&(f.fetch=E?"stale":"refresh",_&&E&&(f.returnedStale=!0)),_?A.__staleWhileFetching:A.__returned=A}}async forceFetch(t,e={}){let s=await this.fetch(t,e);if(s===void 0)throw new Error("fetch() returned undefined");return s}memo(t,e={}){let s=this.#R;if(!s)throw new Error("no memoMethod provided to constructor");let{context:r,forceRefresh:n,...o}=e,a=this.get(t,o);if(!n&&a!==void 0)return a;let h=s(t,a,{options:o,context:r});return this.set(t,h,o),h}get(t,e={}){let{allowStale:s=this.allowStale,updateAgeOnGet:r=this.updateAgeOnGet,noDeleteOnStaleGet:n=this.noDeleteOnStaleGet,status:o}=e,a=this.#s.get(t);if(a!==void 0){let h=this.#t[a],u=this.#e(h);return o&&this.#_(o,a),this.#p(a)?(o&&(o.get="stale"),u?(o&&s&&h.__staleWhileFetching!==void 0&&(o.returnedStale=!0),s?h.__staleWhileFetching:void 0):(n||this.#A(t,"expire"),o&&s&&(o.returnedStale=!0),s?h:void 0)):(o&&(o.get="hit"),u?h.__staleWhileFetching:(this.#F(a),r&&this.#C(a),h))}else o&&(o.get="miss")}#W(t,e){this.#f[e]=t,this.#l[t]=e}#F(t){t!==this.#o&&(t===this.#h?this.#h=this.#l[t]:this.#W(this.#f[t],this.#l[t]),this.#W(this.#o,t),this.#o=t)}delete(t){return this.#A(t,"delete")}#A(t,e){let s=!1;if(this.#r!==0){let r=this.#s.get(t);if(r!==void 0)if(s=!0,this.#r===1)this.#L(e);else{this.#D(r);let n=this.#t[r];if(this.#e(n)?n.__abortController.abort(new Error("deleted")):(this.#T||this.#c)&&(this.#T&&this.#m?.(n,t,e),this.#c&&this.#a?.push([n,t,e])),this.#s.delete(t),this.#i[r]=void 0,this.#t[r]=void 0,r===this.#o)this.#o=this.#f[r];else if(r===this.#h)this.#h=this.#l[r];else{let o=this.#f[r];this.#l[o]=this.#l[r];let a=this.#l[r];this.#f[a]=this.#f[r]}this.#r--,this.#w.push(r)}}if(this.#c&&this.#a?.length){let r=this.#a,n;for(;n=r?.shift();)this.#y?.(...n)}return s}clear(){return this.#L("delete")}#L(t){for(let e of this.#S({allowStale:!0})){let s=this.#t[e];if(this.#e(s))s.__abortController.abort(new Error("deleted"));else{let r=this.#i[e];this.#T&&this.#m?.(s,r,t),this.#c&&this.#a?.push([s,r,t])}}if(this.#s.clear(),this.#t.fill(void 0),this.#i.fill(void 0),this.#d&&this.#x&&(this.#d.fill(0),this.#x.fill(0)),this.#b&&this.#b.fill(0),this.#h=0,this.#o=0,this.#w.length=0,this.#g=0,this.#r=0,this.#c&&this.#a){let e=this.#a,s;for(;s=e?.shift();)this.#y?.(...s)}}};var U={};U.bytes=new et({max:500,maxSize:1e5,maxEntrySize:500,sizeCalculation:(i,t)=>i.length});U.msg=new et({max:1e4});var Ni=["bytes","view.txt","view.json"],Bt="view.txt",P=new K,Hi=P.inv;function it(i){return{bytes:`refs/heads/kv/values/${i}/bytes`,type:`refs/heads/kv/values/${i}/type`,expiry:`refs/heads/kv/expiries/${i}/dayID`,key:`refs/tags/kv/keys/${i}/key`}}function Ii(i){return i.startsWith("refs/")||(i="refs/heads/"+i),i.split("/").slice(4,-1).join("/")}function Wi({mimeType:i,extension:t}={}){return i&&t?`${i};extension=${t}`:i??""}function Li(i){if(!i)return{};let[t,e]=i.split(";"),s=e?.split("=").pop();return{mimeType:t,extension:s}}var gt=class{repository;async commitTyped(t,{encrypt:e,push:s}={}){if(t===void 0)return{};let{type:r,mimeType:n,bytes:o,extension:a}=await Qt(t),h=[...Ni];n&&a&&h.push(`view.${a}`);let u=Wi({mimeType:n,extension:a}),d=await this.repository.commitBytes(o,{message:u,paths:h,encrypt:e,push:s}),l,c=e??this.repository.encrypted;return a&&c===!1&&(l=this.repository.cdnLinks(d,`view.${a}`)),{commitHash:d,type:r,cdnLinks:l}}async fetchTyped(t,e,{decrypt:s,blobHash:r,commitMsg:n}={}){if(t===void 0)return;let o;this.repository.isPublic?o=this.repository.fetchCommitContent(t,{decrypt:s,path:Bt}):U.bytes.has(t)?o=U.bytes.get(t):r?o=this.repository.fetchBlobContent(r,{decrypt:s}).then(h=>(U.bytes.set(t,h),h)):o=this.repository.fetchCommitContent(t,{decrypt:s,path:Bt}).then(h=>(U.bytes.set(t,h),h)),n=n??U.msg.get(t),e==="Blob"&&n===void 0&&(n=await this.repository.fetchCommitMessage(t).then(h=>(U.msg.set(t,h),h)));let{mimeType:a}=Li(n);return te({bytes:await o,type:e,mimeType:a})}async init(){let t=[];for(let e of At){let{commitHash:s}=await this.commitTyped(e,{encrypt:!1});t.push({afterOid:s,name:`refs/tags/kv/types/${e}/type`})}await this.repository.updateRefs(t)}static async instantiate(t,{auth:e,encrypt:s,decrypt:r,fetch:n}={}){let o={name:"a a",email:"a@a.a",date:"2025-01-01T00:00:00Z"},a=await tt.instantiate(t,{committer:o,auth:e,encrypt:s,decrypt:r,fetch:n}),h=new this(a,{callerThis:this});if(P.size===0)for(let u of At){let{commitHash:d}=await h.commitTyped(u,{encrypt:!1,push:!1});P.set(u,d)}return h}constructor(t,{callerThis:e}={}){if(this.constructor!==e){let s=this.constructor.name;throw new TypeError(`Instantiate with 'await ${s}.instantiate()' instead of 'new ${s}()'`,{cause:"async constructor"})}this.repository=t}async keyToUuid(t,{push:e=!1}={}){let{commitHash:s,type:r}=await this.commitTyped(t,{push:e});return{uuid:`${r}/${Lt(s)}`,type:r,commitHash:s}}async uuidToKey(t){let[e,s]=t.split("/"),r=qt(s);return this.fetchTyped(r,e)}async create(t,e,{overwrite:s,ttl:r,oldValue:n}={}){let o,a;switch(s){case!0:o=!1;break;case!1:if(n!==void 0)throw new Error("Cannot have oldValue when overwrite: false");a=null;default:o=!0}let h,u;Number.isFinite(r)&&(h=Ot(r),u=J(h));let[{uuid:d,commitHash:l},{commitHash:c,type:p,cdnLinks:b},{commitHash:m},{commitHash:w,type:f}]=await Promise.all([this.keyToUuid(t,{push:o}),this.commitTyped(e,{push:!0}),this.commitTyped(u,{push:!0,encrypt:!1}),this.commitTyped(n,{push:!1})]);e===void 0?(l=null,m=null):s===!0&&(a=l);let y=it(d);try{return await this.repository.updateRefs([{beforeOid:a,afterOid:l,name:y.key},{beforeOid:w,afterOid:c,name:y.bytes},{beforeOid:P.get(f),afterOid:P.get(p),name:y.type},{afterOid:m,name:y.expiry}]),{uuid:d,cdnLinks:b,expiry:h}}catch(v){throw s===!1&&await this.has(t)===!0?new Error("Key exists"):s===!0&&await this.has(t)===!1?new Error("Nothing to overwrite"):p&&await this.repository.hasCommit(P.get(p))===!1?new Error("Database not initialized. Run db.init()"):new Error("Failed",{cause:v})}}async has(t){let{uuid:e}=await this.keyToUuid(t);return this.repository.hasRef(it(e).key)}async read(t){let{uuid:e}=await this.keyToUuid(t),s=it(e),r=s.bytes,n=s.type,o=s.expiry,a,h,u,d,l,c;if(this.repository.authenticated){let{bytes:b,type:m,expiry:w}=await this.repository.graphql(`
          query($id: ID!, $bytesRef: String!, $typeRef: String!, $expiryRef: String!, $path: String!) {
            node(id: $id) {
              ... on Repository {
                bytes: ref(qualifiedName: $bytesRef) {
                  target {
                    oid
                    ... on Commit {
                      message
                      file(path: $path){
                        oid
                      }
                    }
                  }
                }
                type:ref(qualifiedName: $typeRef) {
                  target {
                    oid
                  }
                }
                expiry:ref(qualifiedName: $expiryRef) {
                  target {
                    oid
                    ... on Commit {
                      file(path: $path){
                        object {
                          ... on Blob {
                            text
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        `,{id:this.repository.id,bytesRef:r,typeRef:n,expiryRef:o,path:Bt}).then(f=>f.node);a=b?.target?.oid,h=b?.target?.message,u=b?.target?.file?.oid,d=m?.target?.oid,c=Number(w?.target?.file?.object?.text)}else[a,d,l]=await Promise.all([this.repository.refToCommitHash(r),this.repository.refToCommitHash(n),this.repository.refToCommitHash(o)]);let p=this.fetchTyped(a,Hi.get(d),{blobHash:u,commitMsg:h});return c=c??await this.fetchTyped(l,"Number",{decrypt:!1}),ae(c)?{}:{value:await p,expiry:c?ne(c):void 0}}async update(t,e,{keepTtl:s=!1,ttl:r}={}){let{value:n,expiry:o}=await this.read(t),a;try{typeof n=="object"&&n!==null?a=await e(structuredClone(n)):a=await e(n)}catch(u){throw new Error('modifier() threw error. See "cause" for details.',{cause:u})}return s&&(r=oe(o)),{...this.create(t,a,{overwrite:!0,ttl:r,oldValue:n}),oldValue:n,newValue:a}}async increment(t,e=1){let s=r=>{if(B(r)!=="Number")throw new Error("Old value must be a Number");return r+e};return this.update(t,s)}async toggle(t){let e=s=>{if(B(s)!=="Boolean")throw new Error("Old value must be a Boolean");return!s};return this.update(t,e)}async delete(t,e=void 0){return this.create(t,void 0,{oldValue:e})}async expire(t,e){let s=J(Ot(e)),[{uuid:r,commitHash:n},{commitHash:o}]=await Promise.all([this.keyToUuid(t),this.commitTyped(s,{push:!0,encrypt:!1})]),a=it(r);try{await this.repository.updateRefs([{beforeOid:n,afterOid:n,name:a.key},{afterOid:o,name:a.expiry}])}catch(h){throw await this.has(t)===!1?new Error("Nothing to expire"):new Error("Failed",{cause:h})}}async deleteUUIDs(t){let e=[];for(let s of t)Object.values(it(s)).forEach(n=>{e.push({name:n,afterOid:null})});return this.repository.updateRefs(e)}async gc(t=new Date,{batchSize:e=10}={}){let{commitHash:s}=await this.commitTyped(ut(t),{encrypt:!1,push:!1});if(!await this.repository.hasCommit(s))return 0;let r=await this.repository.listBranchesTo(s),n=[];for(let o=0;o<r.length;o+=e)n.push(this.deleteUUIDs(r.slice(o,o+e).map(a=>Ii(a))));return await Promise.all(n),r.length}};export{gt as default};
/*! Bundled license information:

date-and-time/esm/date-and-time.mjs:
  (**
   * @preserve date-and-time (c) KNOWLEDGECODE | MIT
   *)
*/
